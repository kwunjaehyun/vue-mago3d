define(["./ComponentDatatype-1a100acd","./when-54335d57","./IndexDatatype-82ceea78","./RuntimeError-88a32665","./createTaskProcessorWorker","./Check-24483042","./WebGLConstants-95ceb4e9","./Math-d6182036"],function(f,A,m,w,t,e,r,n){"use strict";var b;function l(e,t,r){var n,a=e.num_points(),o=r.num_components(),i=new b.AttributeQuantizationTransform;if(i.InitFromAttribute(r)){for(var u=new Array(o),s=0;s<o;++s)u[s]=i.min_value(s);n={quantizationBits:i.quantization_bits(),minValues:u,range:i.range(),octEncoded:!1}}b.destroy(i),(i=new b.AttributeOctahedronTransform).InitFromAttribute(r)&&(n={quantizationBits:i.quantization_bits(),octEncoded:!0}),b.destroy(i);var d=a*o,c=A.defined(n)?function(e,t,r,n,a){var o,i;n.quantizationBits<=8?(i=new b.DracoUInt8Array,o=new Uint8Array(a),t.GetAttributeUInt8ForAllPoints(e,r,i)):(i=new b.DracoUInt16Array,o=new Uint16Array(a),t.GetAttributeUInt16ForAllPoints(e,r,i));for(var u=0;u<a;++u)o[u]=i.GetValue(u);return b.destroy(i),o}(e,t,r,n,d):function(e,t,r,n){var a,o;switch(r.data_type()){case 1:case 11:o=new b.DracoInt8Array,a=new Int8Array(n),t.GetAttributeInt8ForAllPoints(e,r,o);break;case 2:o=new b.DracoUInt8Array,a=new Uint8Array(n),t.GetAttributeUInt8ForAllPoints(e,r,o);break;case 3:o=new b.DracoInt16Array,a=new Int16Array(n),t.GetAttributeInt16ForAllPoints(e,r,o);break;case 4:o=new b.DracoUInt16Array,a=new Uint16Array(n),t.GetAttributeUInt16ForAllPoints(e,r,o);break;case 5:case 7:o=new b.DracoInt32Array,a=new Int32Array(n),t.GetAttributeInt32ForAllPoints(e,r,o);break;case 6:case 8:o=new b.DracoUInt32Array,a=new Uint32Array(n),t.GetAttributeUInt32ForAllPoints(e,r,o);break;case 9:case 10:o=new b.DracoFloat32Array,a=new Float32Array(n),t.GetAttributeFloatForAllPoints(e,r,o)}for(var i=0;i<n;++i)a[i]=o.GetValue(i);return b.destroy(o),a}(e,t,r,d),y=f.ComponentDatatype.fromTypedArray(c);return{array:c,data:{componentsPerAttribute:o,componentDatatype:y,byteOffset:r.byte_offset(),byteStride:f.ComponentDatatype.getSizeInBytes(y)*o,normalized:r.normalized(),quantization:n}}}function a(e){var t=new b.Decoder,r=["POSITION","NORMAL","COLOR","TEX_COORD"];if(e.dequantizeInShader)for(var n=0;n<r.length;++n)t.SkipAttributeTransform(b[r[n]]);var a=e.bufferView,o=new b.DecoderBuffer;if(o.Init(e.array,a.byteLength),t.GetEncodedGeometryType(o)!==b.TRIANGULAR_MESH)throw new w.RuntimeError("Unsupported draco mesh geometry type.");var i=new b.Mesh,u=t.DecodeBufferToMesh(o,i);if(!u.ok()||0===i.ptr)throw new w.RuntimeError("Error decoding draco mesh geometry: "+u.error_msg());b.destroy(o);var s,d,c={},y=e.compressedAttributes;for(var f in y){y.hasOwnProperty(f)&&(s=y[f],d=t.GetAttributeByUniqueId(i,s),c[f]=l(i,t,d))}var A={indexArray:function(e,t){for(var r=e.num_points(),n=e.num_faces(),a=new b.DracoInt32Array,o=3*n,i=m.IndexDatatype.createTypedArray(r,o),u=0,s=0;s<n;++s)t.GetFaceFromMesh(e,s,a),i[u+0]=a.GetValue(0),i[u+1]=a.GetValue(1),i[u+2]=a.GetValue(2),u+=3;return b.destroy(a),{typedArray:i,numberOfIndices:o}}(i,t),attributeData:c};return b.destroy(i),b.destroy(t),A}function o(e){return(A.defined(e.primitive)?a:function(e){var t=new b.Decoder;e.dequantizeInShader&&(t.SkipAttributeTransform(b.POSITION),t.SkipAttributeTransform(b.NORMAL));var r=new b.DecoderBuffer;if(r.Init(e.buffer,e.buffer.length),t.GetEncodedGeometryType(r)!==b.POINT_CLOUD)throw new w.RuntimeError("Draco geometry type must be POINT_CLOUD.");var n=new b.PointCloud,a=t.DecodeBufferToPointCloud(r,n);if(!a.ok()||0===n.ptr)throw new w.RuntimeError("Error decoding draco point cloud: "+a.error_msg());b.destroy(r);var o,i,u={},s=e.properties;for(var d in s){s.hasOwnProperty(d)&&(o=s[d],i=t.GetAttributeByUniqueId(n,o),u[d]=l(n,t,i))}return b.destroy(n),b.destroy(t),u})(e)}function i(e){b=e,self.onmessage=t(o),self.postMessage(!0)}return function(e){var t=e.data.webAssemblyConfig;if(A.defined(t))return require([t.modulePath],function(e){A.defined(t.wasmBinaryFile)?(A.defined(e)||(e=self.DracoDecoderModule),e(t).then(function(e){i(e)})):i(e())})}});
